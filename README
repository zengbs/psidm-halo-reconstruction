#######################
#  Compile Procedure  #
#######################

1. Edit the the path include and lib path for MKL/LAPACK in Makefile, with proper CFLAGS and LDFLAGS according to user's envirnoment.
2. The TEST_FLAG is only used for input parameter I/O test and only valid for run_pot.cpp (not included in run_amp.cpp and run_halo.cpp). Besure to comment TEST_FLAG out and then compile if a formal run is to be conducted.
3. Run the script "make.sh" via: "sh make.sh mkl/lapack oct/nooct". mkl/lapack is for choosing MKL/LAPACK for compiling, while oct/nooct is for selecting to run RECONHALO with/without octant decomposition(no effect for RECONPOT and RECOMAMP), which might be useful if the halo reconstruction is expensive and time-consuming (large lattice size or eigen modes).  

=======================================================================================================================================
#######################
#  Runtime Procedure  #
#######################

Input parameters:
    MASS: 	        axion mass, in unit of eV
    RED_SHIFT        scaling factor a = 1/(1+z)
    FILE_R           file name for saving the real part of 3D wave function are execuation RECONHALO completes; if OCTANT_DECOMPOSE is selected, a suffix "_octantXX" will be added automatically, where "XX" is the index of octant
    FILE_I           file name for saving the imaginary part of 3D wave function are execuation RECONHALO completes; if OCTANT_DECOMPOSE is selected, a suffix "_octantXX" will be added automatically, where "XX" is the index of octant
    INIT_POT         file name for the automatically generated potential initial guess
    FINAL_POT        file name for the automatically generated potential output after iteration 
    R_RANGE          maximum distance the potential will be calculated
    BOX_RANGE        box size for 3D wave function reconstruction, center of halo will be placed rouhlgy at the box center automatically
    R_EIGEN          maximum radial distance for determing the energy cut-off for discretized radial eigen problem (set to around virial radius)
    NBOX             grid of the box; when ocatant is selected, this parameter will be the grid of box in that octant
    RSIZ             number of interval which R_RANGE will be cutted into
    LSIZ             maximum number of quantum number L
    NSIZ             maximum number of quantum number N
    LNOD             number of MPI ranks, LSIZ will be divided into LNOD portion and radial eigen problem is solved simultaneously on each rank
    BETA             parameter for Fermionic-King distribution function, inverse of temperature
    ESCAPE_E         parameter for Fermionic-King distribution function, E_c
    MU0              parameter for Fermionic-King distribution function, eigen stated below MU0 will be suppressed
    HALOMASS         halo mass in unit of 10^11 M_sun
    PERTURB          strength of perturbation for calculating the perturbed eigen energies
    OCTANT           index of the octant where the 3D wave funtion will be constructed when OCTANT_DECOMPOSE is selected
    OMEGA_MO         cosmology parameters, mass density
    SMALL_HO         cosmology parameters, (no unit) Hubble constant h_0
    MASS_CORE_RATIO  ratio between the real core mass and that predicted by core_mass-halo_mass relation, which can be adjusted to describe the deviation from core_mass-halo_mass relation
    NFW_C            concentratio parameter for NFW profile
    PHASE_BETWEEN_RI phase for determing real and imaginary part of the ground state (soliton) wave function (cos and sin)
    CRITERIA         stopping criteria for iteration in run_pot.cpp
    CONTRAST_FACTOR  for determing virial radius, i.e. the mean density inside virial radius will be CONTRAST_FACTOR times critical matter density

A. RECONPOT
    1. Set the corresponding parametersi.
    2. Appropriate RSIZ, LSIZ, NSIZ should be chosen for differnt HALOMASS, to ensure the resolution is good enough and eigen modes are sufficient.
    3. mpirun
    3. For given RSIZ, LSZI, NSIZ, and HALOMASS, BETA and MU0 should be fine tuned to get reasonable density profile, i.e. with stable soliton in inner part and NFW profile for outer part.

B. RECONAMP
    1. Set the corresponding parameters consistently according to RECONPOT.
    2. Bsure that the final potential output (with the name set by FINAL_POT when running RECONPOT) is under the same directory.
    3. mpirun.

C. RECONHALO
    1. Set the corresponding parameters consistently according to RECONAMP. Beware that when OCTANT_DECOMPOSE is going to be used, parameter "OCTANT" should be added to the parameter_r.txt and parameter "NBOX" will be the grid in that octant.
    2. BOX_RANGE should be selected properly such that the resolution is enough to resolved the interfernce pattern of the wave function.
    3. Besure that the output binary files generated by RECOMAMP (egnXX.bin and amp_onlyLXX.bin) are under the same directory.
    4. mpirun.
    
       
       
       
       
